<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fit a single transform to a bridging registration between brains — fit_xform_brain • nat.templatebrains</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fit a single transform to a bridging registration between brains — fit_xform_brain"><meta property="og:description" content="Fit a single transform to a bridging registration between brains"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nat.templatebrains</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="../SUPPORT.html">Help</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://natverse.github.io" class="external-link">natverse</a>
</li>
<li>
  <a href="https://github.com/natverse/nat.templatebrains" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit a single transform to a bridging registration between brains</h1>
    <small class="dont-index">Source: <a href="https://github.com/natverse/nat.templatebrains/blob/HEAD/R/fit-xform.R" class="external-link"><code>R/fit-xform.R</code></a></small>
    <div class="hidden name"><code>fit_xform_brain.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fit a single transform to a bridging registration between brains</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_xform_brain</span><span class="op">(</span></span>
<span>  <span class="va">sample</span>,</span>
<span>  <span class="va">reference</span>,</span>
<span>  via <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"affine"</span>, <span class="st">"rigid"</span>, <span class="st">"similarity"</span>, <span class="st">"tps"</span><span class="op">)</span>,</span>
<span>  pts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  npts <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">pts</span><span class="op">)</span><span class="op">)</span> <span class="fl">1000</span> <span class="kw">else</span> <span class="cn">NULL</span>,</span>
<span>  scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>sample</dt>
<dd><p>Source template brain (e.g. IS2) that data is currently in.
Specified either as character vector or a <code>templatebrain</code> object.</p></dd>


<dt>reference</dt>
<dd><p>Target template brain (e.g. IS2) that data should be
transformed into.</p></dd>


<dt>via</dt>
<dd><p>(optional) intermediate template brain that the registration
sequence must pass through.</p></dd>


<dt>type</dt>
<dd><p>A character string specifying the type of registration. See
<code>computeTransform</code> for details.</p></dd>


<dt>pts</dt>
<dd><p>Optional set of points to use for the fit. If they are not
specified they will be randomly sampled (see details).</p></dd>


<dt>npts</dt>
<dd><p>Number of points to use for fit (defaults to 1000 when no
<code>pts</code> argument is specified).</p></dd>


<dt>scale</dt>
<dd><p>a 2-vector indicating the amount to scale the sample and
reference points. You can supply one vector if this is the same. If the
transform expects points in microns and returns points in microns then you
would need <code>scale=c(1000,1)</code> if you want the input to be in microns
and the output to be in nm.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments passed to <code><a href="fit_xform.html">fit_xform</a></code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A homogeneous affine matrix or a <code><a href="https://rdrr.io/pkg/nat/man/tpsreg.html" class="external-link">tpsreg</a></code> object</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>If <code>pts</code> are supplied these will be used to construct the fit.
  This might be useful if you are focussing on a particular brain region and
  supply relevant neurons. But if you want to work with one registration to
  use for the whole brain then it's better to use points across the brain.</p>
<p>When points are not provided then <code>fit_xform_brain</code> will first check
  to see if it can find a neuropil surface model for the <code>sample</code>. If it
  can, it will sample a number of points that lie inside the surface model.
  If no surface model can be found, then it will look for a
  <code><a href="templatebrain.html">templatebrain</a></code> object specifying a bounding box around the
  sample brain. If successful, it will sample <code>npts</code> within that
  bounding box. If not there will be an error and you will have to supply the
  points.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="fit_xform.html">fit_xform</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/natverse/nat.flybrains" class="external-link">nat.flybrains</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">t1</span><span class="op">=</span><span class="fu">fit_xform_brain</span><span class="op">(</span>sample<span class="op">=</span><span class="st">'FCWB'</span>, reference<span class="op">=</span><span class="st">"JFRC2"</span>, type<span class="op">=</span><span class="st">'affine'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">t1</span></span></span>
<span class="r-in"><span><span class="co"># the same but for points in nm</span></span></span>
<span class="r-in"><span><span class="fu">fit_xform_brain</span><span class="op">(</span>sample<span class="op">=</span><span class="st">'FCWB'</span>, reference<span class="op">=</span><span class="st">"JFRC2"</span>, type<span class="op">=</span><span class="st">'affine'</span>, scale<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># run the fit based on a particular group of Kenyon cells</span></span></span>
<span class="r-in"><span><span class="va">t2</span><span class="op">=</span><span class="fu">fit_xform_brain</span><span class="op">(</span>sample<span class="op">=</span><span class="st">'FCWB'</span>, reference<span class="op">=</span><span class="st">"JFRC2"</span>,</span></span>
<span class="r-in"><span>  pts<span class="op">=</span><span class="fu">nat</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/nat/man/kcs20.html" class="external-link">kcs20</a></span>, npts<span class="op">=</span><span class="fl">300</span>, type<span class="op">=</span><span class="st">'affine'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/nat/man/nclear3d.html" class="external-link">nclear3d</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/mfrow3d.html" class="external-link">mfrow3d</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, sharedMouse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/plot3d.html" class="external-link">plot3d</a></span><span class="op">(</span><span class="va">JFRC2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/plot3d.html" class="external-link">plot3d</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nat/man/xform.html" class="external-link">xform</a></span><span class="op">(</span><span class="va">FCWB.surf</span>, <span class="va">t1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/mfrow3d.html" class="external-link">next3d</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/plot3d.html" class="external-link">plot3d</a></span><span class="op">(</span><span class="va">JFRC2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/plot3d.html" class="external-link">plot3d</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nat/man/xform.html" class="external-link">xform</a></span><span class="op">(</span><span class="va">FCWB.surf</span>, <span class="va">t2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># the whole brain surfaces clearly match better when you fit on the whole brain</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Gregory Jefferis, James Manton.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

